{% extends "base.html" %}
{% load i18n %}
{% load account socialaccount %}

{% block head_title %}{% trans "Sign In" %}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/login-card.css">
{% endblock %}

{% block content %}
<div class="login-container">
  <!-- Animated background elements -->
  <div class="login-bg-circle login-bg-circle-1"></div>
  <div class="login-bg-circle login-bg-circle-2"></div>
  <div class="login-bg-circle login-bg-circle-3"></div>

  <!-- Floating particles -->
  <div class="login-particles">
    <div class="login-particle"></div>
    <div class="login-particle"></div>
    <div class="login-particle"></div>
    <div class="login-particle"></div>
    <div class="login-particle"></div>
    <div class="login-particle"></div>
    <div class="login-particle"></div>
    <div class="login-particle"></div>
  </div>

  <div class="login-card">
    <div class="login-card-inner">
      <!-- Left side - Branding -->
      <div class="login-brand">
        <div class="login-brand-content">
          <div class="login-logo">
            <img src="/static/images/logo-white.png" alt="Library Management System" class="img-fluid">
          </div>
          <h1 class="login-title">Library Management System</h1>
          <p class="login-subtitle">Your complete solution for modern library management</p>

          <div class="login-features">
            <div class="login-feature">
              <div class="login-feature-icon">
                <i class="fas fa-book-reader"></i>
              </div>
              <div class="login-feature-text">
                <h3>Digital Catalogs</h3>
                <p>Manage your entire collection digitally</p>
              </div>
            </div>

            <div class="login-feature">
              <div class="login-feature-icon">
                <i class="fas fa-chart-line"></i>
              </div>
              <div class="login-feature-text">
                <h3>Analytics Dashboard</h3>
                <p>Track usage and optimize your library</p>
              </div>
            </div>

            <div class="login-feature">
              <div class="login-feature-icon">
                <i class="fas fa-users"></i>
              </div>
              <div class="login-feature-text">
                <h3>Member Management</h3>
                <p>Streamline member services and engagement</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right side - Login form -->
      <div class="login-form-side">
        <div class="login-form-wrapper">
          <div class="login-header">
            <h2>{% trans "Welcome Back" %}</h2>
            <p>Sign in to access your library dashboard</p>
          </div>

          <!-- User Role Selector -->
          <div class="login-role-selector">
            <div class="role-selector-tabs">
              <input type="radio" class="role-selector-input" name="login-role" id="member" checked>
              <label class="role-selector-label" for="member">
                <i class="fas fa-user"></i>
                <span>Member</span>
              </label>

              <input type="radio" class="role-selector-input" name="login-role" id="library-admin">
              <label class="role-selector-label" for="library-admin">
                <i class="fas fa-user-tie"></i>
                <span>Library Admin</span>
              </label>

              <input type="radio" class="role-selector-input" name="login-role" id="super-admin">
              <label class="role-selector-label" for="super-admin">
                <i class="fas fa-user-shield"></i>
                <span>Super Admin</span>
              </label>

              <div class="role-selector-glider"></div>
            </div>
          </div>

          {% if messages %}
          <div class="login-messages">
            {% for message in messages %}
            <div class="login-message {% if message.tags == 'error' %}login-message-error{% else %}login-message-{{ message.tags }}{% endif %}">
              <div class="login-message-icon">
                {% if message.tags == 'error' %}
                <i class="fas fa-exclamation-circle"></i>
                {% elif message.tags == 'success' %}
                <i class="fas fa-check-circle"></i>
                {% elif message.tags == 'info' %}
                <i class="fas fa-info-circle"></i>
                {% elif message.tags == 'warning' %}
                <i class="fas fa-exclamation-triangle"></i>
                {% else %}
                <i class="fas fa-bell"></i>
                {% endif %}
              </div>
              <div class="login-message-content">
                {{ message }}
              </div>
              <button type="button" class="login-message-close" aria-label="Close">
                <i class="fas fa-times"></i>
              </button>
            </div>
            {% endfor %}
          </div>
          {% endif %}

          <form class="login-form" method="POST" action="{% url 'account_login' %}">
            {% csrf_token %}

            <div class="login-form-group">
              <div class="login-input-wrapper">
                <div class="login-input-icon">
                  <i class="fas fa-envelope"></i>
                </div>
                <input type="email" name="login" id="id_login" class="login-input" placeholder="Email address" required>
              </div>
            </div>

            <div class="login-form-group">
              <div class="login-input-wrapper">
                <div class="login-input-icon">
                  <i class="fas fa-lock"></i>
                </div>
                <input type="password" name="password" id="id_password" class="login-input" placeholder="Password" required>
                <button type="button" class="login-password-toggle" id="togglePassword">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>

            <div class="login-form-options">
              <div class="login-remember">
                <input type="checkbox" name="remember" id="id_remember" class="login-checkbox">
                <label for="id_remember" class="login-checkbox-label">Remember me</label>
              </div>
              <a href="{% url 'account_reset_password' %}" class="login-forgot-link">{% trans "Forgot Password?" %}</a>
            </div>

            {% if redirect_field_value %}
            <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
            {% endif %}

            <button type="submit" class="login-button">
              <span class="login-button-text">{% trans "Sign In" %}</span>
              <span class="login-button-icon">
                <i class="fas fa-arrow-right"></i>
              </span>
            </button>

            <div class="login-signup">
              <span>Don't have an account?</span>
              <a href="{% url 'account_signup' %}" class="login-signup-link">{% trans "Create Account" %}</a>
            </div>
          </form>

          {% if socialaccount_providers %}
          <div class="login-social">
            <div class="login-social-divider">
              <span>Or continue with</span>
            </div>
            <div class="login-social-buttons">
              {% for provider in socialaccount_providers %}
                {% if provider.id == 'google' %}
                <a href="{% provider_login_url provider.id process='login' %}" class="login-social-button login-social-google">
                  <i class="fab fa-google"></i>
                  <span>Google</span>
                </a>
                {% elif provider.id == 'facebook' %}
                <a href="{% provider_login_url provider.id process='login' %}" class="login-social-button login-social-facebook">
                  <i class="fab fa-facebook-f"></i>
                  <span>Facebook</span>
                </a>
                {% elif provider.id == 'twitter' %}
                <a href="{% provider_login_url provider.id process='login' %}" class="login-social-button login-social-twitter">
                  <i class="fab fa-twitter"></i>
                  <span>Twitter</span>
                </a>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          {% endif %}
        </div>

        <div class="login-footer">
          <p>&copy; {% now "Y" %} Library Management System. All rights reserved.</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/login-card.js"></script>
{% endblock %}
